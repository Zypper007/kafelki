try{if(void 0!==y3Qc6aR)throw new Error("Czater script loaded twice");var Rf2jK5f=!1,showChat,hideChat,tries=0,socket=!1,y3Qc6aR,e3D18r_czater={},$czaterMethods={};!function(){var interval=null,czaterEvents=!1,czaterSR=!1,titleInterval=!1,originTitle=document.title,titleSemaphore=!1,previousMessagesLoaded=!1;"undefined"==typeof httpRef&&(httpRef=!1);var myCache={currentCache:0,constants:{timestamp:"e3D18r_cache_timestamp",language:"e3D18r_cache_language",template:"e3D18r_cache_template",callLangs:"e3D18r_cache_call_langs",callCountries:"e3D18r_cache_call_countries",exclusionsDesktop:"e3D18r_cache_exclusionsDesktop",exclusionsMobile:"e3D18r_cache_exclusionsMobile"},setNewCacheTimestamp:function(e){var t=e3D18r_czater.sessionStorage.getItem(this.constants.timestamp);Number(e)!==Number(t)&&(this.clearCaches(),e3D18r_czater.sessionStorage.setItem(this.constants.timestamp,e))},getCache:function(e){var t=e3D18r_czater.sessionStorage.getItem(e);return!!t&&JSON.parse(t)},setCache:function(e,t){e3D18r_czater.sessionStorage.setItem(e,JSON.stringify(t))},clearCaches:function(){var e=this;Object.keys(this.constants).forEach(function(t){e3D18r_czater.sessionStorage.removeItem(e.constants[t])})}},main,destroy;function startTitleInterval(){function e(e){titleSemaphore||(titleSemaphore=!0,originTitle=document.title,document.title=e,setTimeout(function(){document.title=originTitle,titleSemaphore=!1},2e3))}var t="";e(t+="pol"===lang?"Konsultant pisze...":"The consultant writes..."),titleInterval&&(clearInterval(titleInterval),titleInterval=!1),titleInterval=setInterval(function(){e(t)},6e3)}function stopTitleInterval(){titleInterval&&(clearInterval(titleInterval),titleInterval=!1),document.title=originTitle,titleSemaphore=!1}void 0===window.main&&(window.main=function(){"function"==typeof main&&loadScript(src,main)}),$czaterMethods.main=function(){"function"==typeof main&&loadScript(src,main)},void 0===window.destroy&&(window.destroy=function(){"function"==typeof destroy&&destroy()});var localStorageTest=!0;try{localStorage.getItem("testLocalStorage")}catch(e){console.log(e),localStorageTest=!1}"localStorage"in window&&0!=localStorageTest?(e3D18r_czater.localStorage=localStorage,e3D18r_czater.sessionStorage=sessionStorage):(e3D18r_czater.localStorage={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}},e3D18r_czater.sessionStorage={length:0,setItem:function(e,t){document.cookie=e+"="+t+"; path=/",this.length++},getItem:function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0,o=a.length;n<o;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},removeItem:function(e){this.setItem(e,"",-1),this.length--},key:function(e){var t=document.cookie.split(";");if(e>=t.length||isNaN(parseFloat(e))||!isFinite(e))return null;for(var a=t[e];" "===a.charAt(0);)a=a.substring(1,a.length);return a.substring(0,a.indexOf("="))}});var w4Ue7Lb={pl:["","pol","polish"],de:["_de","deu","german"],fr:["_fr","fra","french"],es:["_es","spa","spanish"],ru:["_ru","rus","russian"],sv:["_sv","swe","swedish"],ro:["_ro","rom","romanian"],el:["_el","grc","greek"],cs:["_cs","ces","czech"],sk:["_sk","slk","slovak"],bg:["_bg","bul","bulgarian"],nl:["_nl","nld","dutch"],it:["_it","ita","italian"],pt:["_pt","por","portuguese"],en:["_en","eng","english"],uk:["_uk","ukr","ukrainian"],hu:["_hu","hun","hungarian"],no:["_no","nob","norwegian"],lv:["_lv","lav","latvian"],lt:["_lt","lit","lithuanian"]};function doCloseConversation(){slideToggle(),messagesCount=0,convInProgress=0,socket.emit("ToServerCloseConversation",{adminHash:window.$czater.tok,chatHash:chatHash,whoClose:"client",sendSurvey:!0}),window.location.href.indexOf("getChatWindowed")>-1&&window.close()}function callIfUserLeaves(e){var t,a,n=!1,o=!1;a=function(){o&&!n&&(n=!0,document.removeEventListener("mousemove",t),e())},t=function(e){var t=window.innerHeight,n=e.movementY,r=e.clientY;n<0&&r<t/10?(o=!0,document.addEventListener("mouseout",a)):(o=!1,document.removeEventListener("mouseleave",a))},setTimeout(function(){document.addEventListener("mousemove",t)},1e3)}function callIfUserScrolls(e,t){var a;a=function(){window.scrollY>=e&&(removeEventListener("scroll",a),t())},addEventListener("scroll",a)}if(window.$czater&&void 0===y3Qc6aR&&window.$czater.tok){y3Qc6aR=!0;var base_url=static_url="https://www.czater.pl/";window.$czater.domain&&(base_url=window.$czater.domain);var w=screen.width,h=screen.height,srcRecorder="assets/modules/chat/js/recorder.js",srcCall="assets/modules/chat/js/czatercall.js",recordingInterval=!1,liveInterval=!1,allowSend=!0,recorder=!1,calling=!1,isSections=0,absolutelyFirst=!0,randomizeTime=!1,ifKruk=0,googleAnalytics=0,liveInterval=!1,ip="127.0.0.1",portFix,hideBrand=!1,port="",switch_from_bot="",previousStatusData={},first;first=window.$czater.tok.charCodeAt(0),portFix=first>="0".charCodeAt(0)&&first<="3".charCodeAt(0)||base_url.indexOf("czaterdev.pl")>=0?"s1":first>="4".charCodeAt(0)&&first<="7".charCodeAt(0)?"s2":first>="8".charCodeAt(0)&&first<="b".charCodeAt(0)?"s3":"s4",port+=portFix;var date2str=function(date,format){var z={M:date.getMonth()+1,d:date.getDate(),h:date.getHours(),m:date.getMinutes(),s:date.getSeconds()};return format=format.replace(/(M+|d+|h+|m+|s+)/g,function(v){return((v.length>1?"0":"")+eval("z."+v.slice(-1))).slice(-2)}),format.replace(/(y+)/g,function(e){return date.getFullYear().toString().slice(-e.length)})},isRecording=!0,recId=!1,exclusion=!1,referer=document.URL,canGetUserStatus=!1,canGetTemplate=!1,frameLoadedDetail=!1,triesInterval=null,internetInterval=null,testInterval=null,connectionsInterval=null,currentUrlInterval=null,mainLoaded=!1,maxTries=4,socketConnected=!1,firstEnter=!0,firstCookie=!0,firstRefererSent=!0,firstSettingsSent=!0,always=0,urls=[],cssLoaded=!1,allTriggers=[],showTitle=0,username=null,welcomeCloseSelect,triggerWelcomeSelect,clientCustomFields=!1,socket_path=!1;base_url.indexOf("czat.kruksa.pl")>-1?socket_url="https://s01.czat.kruksa.pl/":base_url.indexOf("chat.it.kruk.eu")>-1?socket_url="https://s1it.chaterbiz.com/":base_url.indexOf("chat.es.kruk.eu")>-1?socket_url="https://s1es.chaterbiz.com/":base_url.indexOf("servizioclienti.chat")>-1?socket_url="https://s2.olog.pl/":base_url.indexOf("olog.pl")>-1||base_url.indexOf("olog.biz")>-1?socket_url="https://s4.olog.pl/":base_url.indexOf("qlog.pl")>-1||base_url.indexOf("qlog.biz")>-1?socket_url="https://"+port+".qlog.pl/":base_url.indexOf("czater.pl")>-1||base_url.indexOf("chater.biz")>-1?socket_url="https://"+port+".czater.pl/":base_url.indexOf("chater.pl")>-1||base_url.indexOf("chaterbiz.com")>-1?socket_url="https://"+port+".chater.pl/":base_url.indexOf("czaterdev.pl")>-1&&base_url.indexOf("https")>-1?socket_url="https://"+port+".czaterdev.pl/":base_url.indexOf("live-chat.pl")>-1&&base_url.indexOf("https")>-1?socket_url="https://"+port+".live-chat.pl/":base_url.indexOf("callchat.pl")>-1&&base_url.indexOf("https")>-1&&(socket_url="https://"+port+".callchat.pl/");var parts=base_url.split(".");parts.shift();var COOKIE_SITE=parts.join(".");"/"===COOKIE_SITE[COOKIE_SITE.length-1]&&(COOKIE_SITE="."+COOKIE_SITE.substring(0,COOKIE_SITE.length-1));var createCookie=function(e,t,a){var n="";if(a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3),n="; expires="+o.toGMTString()}document.cookie=e+"="+t+n+"; path=/"},readCookie=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var o=a[n];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},chatLoaded=!1,anotherTab=!1,templateLoaded=!1,templateData=!1,currentWidget=!1,language=encodeURIComponent(window.navigator.userLanguage||window.navigator.language),timestamp=11,notAutoCreate=!1;window.$czater.not_auto_create&&(notAutoCreate=window.$czater.not_auto_create);var additionParams=!1;window.$czater.addition_params&&(additionParams=window.$czater.addition_params);var chatHash="",forceCookie=!1;window.$czater.forceCookie&&(forceCookie=window.$czater.forceCookie,chatHash=forceCookie,window.$czater.chatHash=chatHash);var autoOpen=!1;window.$czater.autoOpen&&(autoOpen=window.$czater.autoOpen);var allowAutoOpen=!0;void 0!==window.$czater.allowAutoOpen&&(allowAutoOpen=window.$czater.allowAutoOpen);var set_windowed=!1;window.$czater.windowed&&(set_windowed=window.$czater.windowed);var set_minimized_button=!1;window.$czater.minimized_button&&(set_minimized_button=window.$czater.minimized_button);var set_chat_color=!1;window.$czater.chat_color&&(set_chat_color=window.$czater.chat_color);var set_message_color=!1;window.$czater.message_color&&(set_message_color=window.$czater.message_color);var set_button_color=!1;window.$czater.button_color&&(set_button_color=window.$czater.button_color);var patron=!1;window.$czater.patron&&(patron=window.$czater.patron);var userLogin=!1;window.$czater.login&&(userLogin=window.$czater.login);var userEmail=!1;window.$czater.email&&(userEmail=window.$czater.email);var idSectionDefault=!1;window.$czater.idSectionDefault&&(idSectionDefault=window.$czater.idSectionDefault);var userSection=!1,czaterCallbackUserSection=!1;window.$czater.section&&(userSection=window.$czater.section,czaterCallbackUserSection=window.$czater.section),window.$czater.sectionCallback&&(czaterCallbackUserSection=window.$czater.sectionCallback);var set_button_hover_color=!1;window.$czater.button_hover_color&&(set_button_hover_color=window.$czater.button_hover_color);var set_button_text_color=!1;window.$czater.button_text_color&&(set_button_text_color=window.$czater.button_text_color);var set_chat_position=!1;window.$czater.chat_position&&(set_chat_position=window.$czater.chat_position);var set_chat_mobile_position=!1;window.$czater.chat_mobile_position&&(set_chat_mobile_position=window.$czater.chat_mobile_position);var set_css_template=!1;window.$czater.css_template&&(set_css_template=window.$czater.css_template);var allegroReferer="";void 0!==window.$czater.allegroReferer&&(allegroReferer=window.$czater.allegroReferer);var forceOffline=!1;void 0!==window.$czater.forceOffline&&(forceOffline=window.$czater.forceOffline);var forceCallback=!1;void 0!==window.$czater.forceCallback&&(forceCallback=window.$czater.forceCallback);var overwriteAdvertHeader="";void 0!==window.$czater.overwriteAdvertHeader&&(overwriteAdvertHeader=window.$czater.overwriteAdvertHeader);var overwriteAdvertText="";void 0!==window.$czater.overwriteAdvertText&&(overwriteAdvertText=window.$czater.overwriteAdvertText);var overwriteWelcomeMessage="";void 0!==window.$czater.overwriteWelcomeMessage&&(overwriteWelcomeMessage=window.$czater.overwriteWelcomeMessage);var overwriteWelcomeOnline=void 0;void 0!==window.$czater.overwriteWelcomeOnline&&(overwriteWelcomeOnline=window.$czater.overwriteWelcomeOnline);var overwriteWelcomeOffline=void 0;void 0!==window.$czater.overwriteWelcomeOffline&&(overwriteWelcomeOffline=window.$czater.overwriteWelcomeOffline),void 0!==window.$czater.language&&(language=window.$czater.language);var clientPerDomain=!1;void 0!==window.$czater.client_per_domain&&(clientPerDomain=window.$czater.client_per_domain);var chatOpenMode="auto";void 0!==window.$czater.chat_open_mode&&(chatOpenMode=window.$czater.chat_open_mode);var allowMobileBack=!1;void 0!==window.$czater.allow_mobile_back&&(allowMobileBack=window.$czater.allow_mobile_back);var videoWindowed=!1;void 0!==window.$czater.videoWindowed&&(videoWindowed=window.$czater.videoWindowed);var externalCSS=[];void 0!==window.$czater.external_css&&(externalCSS=window.$czater.external_css);var excluded=!1,open=!1,incactiveFor=0,lang="pol",welcomeMsg=null,welcome_offlineMsg=null,sectionsStatus=null,chosenSection=null,windowedPressed=!1,firstReferer="",userStatus="offline",isAvatar=!1,initializeConversation=!1,newLayout=0,iframeWindow=null,convInProgress=0,simpleStatus=null===e3D18r_czater.localStorage.getItem("simpleStatus")&&!1===patron?1:0,cookie_prefix="czater",cookie_name="__",cookie_open="__open2_"+window.$czater.tok,cookie_lastMessage="__last-message",cookie_firstReferer="__first-referer",cookie_lastReferer="__first-referer",teaser_shown="__teaser_shown",cookie_teaser_closed="__teaser-closed",cookie_trigger_used="__teaser-closed",cookie_last_section="__last-section",client_email="",client_name="",eventsStarted=!1,tempHash="",windowedUrl="",CookieTTL=365,idConsultant=null,minimizePressed=!1,alreadyStarted=!0,head,body,messagesCount=0,button_online="",header_online="",header_offline="",avatar_online="",chat_color="",text_msg_color="",rounded_corners="",chat_position="",chat_mobile_position="",chatInvitationPosition="",avatar_position="",marking="",noViewPort=!1,intervalMinimizePressed=null,intervalUpdateStatus=null,teaser_timeout=null,chatUnreadBadge="";window.token=!0;var tempHash=readCookie(cookie_prefix+cookie_name+window.$czater.tok);null===tempHash&&(tempHash="");var firstReferer=readCookie(cookie_prefix+cookie_firstReferer);null===firstReferer&&(firstReferer=document.referrer,createCookie(cookie_prefix+cookie_firstReferer,firstReferer,CookieTTL));var isTeaserClosed=null!==readCookie(cookie_prefix+cookie_teaser_closed),lastMessage=readCookie(cookie_prefix+cookie_lastMessage),classAttr,headerClass,all=null,iframeNewMessage=!1,iframeParent=!1,header,unreadMessagesCount=null,unreadBadge,status,avatar,headerMSG,contener,teaser,czatercall_teaser,czatercall_teaser_caption,contenerTeaserCaption,countNewMessages,windowed,minimize,closeConversation,closeConversationMenu,contenerTeaserClose,czaterReturn;window.addEventListener("frameLoaded",function(e){frameLoadedDetail=e.detail},!1),window.addEventListener("message",WindowMessageListener,!1),window.addEventListener("dragenter",function(){postMessage("drag",!1)},!1),window.addEventListener("dragover",function(){postMessage("drag",!1)},!1),window.addEventListener("dragleave",function(){postMessage("drag",!0)},!1),window.addEventListener("drop",function(){postMessage("drag",!0)},!1);var on="addEventListener"in window?function(e,t,a){e&&e.addEventListener(t,a,!1)}:function(e,t,a){e&&e.attachEvent("on"+t,function(){a(window.event)})};showChat=function(e,t){updateUnreadMessages("hide"),"off"===contener.getAttribute("data-display")&&(previousMessagesLoaded||(previousMessagesLoaded=!0,window.postMessage(JSON.stringify({type:"getPrevMessages",value:{idSection:chosenSection,lastMessageId:0}}),"*")),allowMobileBack&&isMobile.any()&&(window.location="#chat-window-open"),contener.setAttribute("data-anim","off"),czaterEvents.sendEvent("showChat"),czaterSR.sendCustomRequest(1,"czater_opened-chat-window",{})),e=void 0===e||e,t=void 0!==t&&t,triggerWelcomeSelect&&(all.querySelector("#trigger-welcome").classList.add("hidden"),all.querySelector("#trigger-welcome").style.display="none"),showChatInside=function(){contener.removeAttribute("data-anim"),contener.setAttribute("data-anim","on"),isMobile.any()&&"offline"===userStatus&&window.scrollTo(0,0),createCookie(cookie_prefix+cookie_open,"1",1),isMobile.any()&&window.innerWidth<window.innerHeight?contener.style.height=window.innerHeight-5+"px":contener.style.height=2==newLayout?"590px":3==newLayout?"600px":0===newLayout?"540px":"550px",contener.style.width="",contener.style.visibility="visible",isAvatar?(headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar")):(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")),countNewMessages.setAttribute("class","czater-disable"),contener.setAttribute("data-display","on"),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":(0==newLayout&&(contener.style.width="350px"),2==newLayout?contener.style.width="380px":3==newLayout?contener.style.width="350px":isMobile.any()?contener.style.width="":contener.style.width="340px"),e&&(headerClass="czater-header czater-header-normal",2!=newLayout&&(isMobile.any()||1===avatar_position||window.location.href.indexOf("getChatWindowed")>-1)&&(headerClass+=" avatarInside"),header.setAttribute("class",headerClass),chosenSection?(headerMSG.innerHTML=header_consultant,""!==avatar_online?(avatar.innerHTML!=avatar_online&&(avatar.innerHTML=avatar_online),headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar")):(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar"),isAvatar=!1,avatar.innerHTML="")):"1"==contener.getAttribute("conversation-ongoing")?headerMSG.innerHTML=header_consultant:(headerMSG.innerHTML=header_online,isAvatar=!1,avatar.innerHTML="")),classAttr="contener-lower",(0===rounded_corners||window.location.href.indexOf("getChatWindowed")>-1)&&(classAttr+=" nonRadius"),set_chat_position&&(chat_position=parseInt(set_chat_position)),1===chat_position&&(classAttr+=" attachment-bottom-right"),2===chat_position?classAttr+=" attachment-bottom-left":3===chat_position?classAttr+=" attachment-right-edge":4===chat_position&&(classAttr+=" attachment-left-edge"),set_chat_mobile_position&&(chat_mobile_position=parseInt(set_chat_mobile_position)),0===chat_mobile_position?classAttr+=" invisible-chat":1===chat_mobile_position?classAttr+=" attachment-mobile-bottom-right":2===chat_mobile_position?classAttr+=" attachment-mobile-bottom-left":3===chat_mobile_position?classAttr+=" attachment-mobile-right-edge":4===chat_mobile_position&&(classAttr+=" attachment-mobile-left-edge"),contener.setAttribute("class",classAttr),iframeNewMessage.style.display="block"},t?showChatInside():setTimeout(function(){showChatInside()},300)};var showChatWindowed=function(){windowed&&windowed.click()},setPatron=function(e){e&&(patron=e)};$czaterMethods.showChat=showChat,$czaterMethods.showChatWindowed=showChatWindowed,$czaterMethods.toggleCallBanner=toggleCallBanner,$czaterMethods.setPatron=setPatron,$czaterMethods.toggleVideoCallBanner=function(){console.log("Video call not ready yet")},hideChat=function(e,t){t=void 0!==t&&t,"on"===contener.getAttribute("data-display")&&(contener.setAttribute("data-anim","off"),czaterEvents.sendEvent("hideChat"),czaterSR.sendCustomRequest(1,"czater_closed-chat-window",{}),allowMobileBack&&isMobile.any()&&history&&history.replaceState&&history.replaceState(null,""," ")),hideChatInside=function(){contener.removeAttribute("data-anim"),contener.setAttribute("data-anim","on"),void 0===e&&(e=!1),set_windowed||(e||createCookie(cookie_prefix+cookie_open,"0",1),contener.removeAttribute("class","contener-lower"),contener.setAttribute("data-display","off"),headerClass="czater-header czater-button",(isMobile.any()||1===avatar_position||window.location.href.indexOf("getChatWindowed")>-1)&&(headerClass+=" avatarInside"),previousStatusData.avatar&&(isAvatar=!0,window.devicePixelRatio>1.5?avatar.innerHTML=previousStatusData.avatar.big:avatar.innerHTML=previousStatusData.avatar.small),headerClass+=" czater-height",header.setAttribute("class",headerClass),classAttr="",(0===rounded_corners||window.location.href.indexOf("getChatWindowed")>-1)&&(classAttr+=" nonRadius"),set_chat_position&&(chat_position=parseInt(set_chat_position)),1===chat_position&&(classAttr+=" attachment-bottom-right"),2===chat_position?classAttr+=" attachment-bottom-left":3===chat_position?classAttr+=" attachment-right-edge":4===chat_position&&(classAttr+=" attachment-left-edge"),set_chat_mobile_position&&(chat_mobile_position=parseInt(set_chat_mobile_position)),0===chat_mobile_position?classAttr+=" invisible-chat":1===chat_mobile_position?classAttr+=" attachment-mobile-bottom-right":2===chat_mobile_position?classAttr+=" attachment-mobile-bottom-left":3===chat_mobile_position?classAttr+=" attachment-mobile-right-edge":4===chat_mobile_position&&(classAttr+=" attachment-mobile-left-edge"),contener.setAttribute("class",classAttr),void 0!==button_online&&(headerMSG.innerHTML=button_online),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":contener.style.width="",contener.style.height="30px",contener.style.visibility="visible",updateUnreadMessages("show"))},t?hideChatInside():setTimeout(function(){hideChatInside()},300)},$czaterMethods.hideChat=hideChat;var openChatDecider=function(e){e=void 0===e||e;var t="stay";return"auto"===chatOpenMode?noViewPort&&window.screen.width<770||isMobile.iPad()||isMobile.iPhone()?(window.event&&windowed.click(),t="windowed"):(e&&showChat(!0),t="stay"):"windowed"===chatOpenMode?(window.event&&windowed.click(),t="windowed"):"stay"===chatOpenMode&&(e&&showChat(!0),t="stay"),t},getTemplate=function(e,t){if(e.template.css.forEach(function(e){(e.name===set_css_template||e.referer&&checkReferer(referer,e.referer))&&(e.auto=1)}),e.template.widgets=currentWidget,templateData=e,!templateLoaded){var a=document.createElement("div");a.innerHTML=e.template.content,body.appendChild(a.firstChild),timestamp=e.template.timestamp,static_url=e.staticUrl+timestamp+"/",srcRecorder=static_url+srcRecorder,srcCall=static_url+srcCall,updateTemplate(e);var n=!1;on(document.getElementById("welcome_text"),"click",function(){t.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider(),n=!1}),on(document.getElementById("chatHeader"),"click",function(){"1"===readCookie(cookie_prefix+cookie_open)||n||(t.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider()),n=!1}),on(document.getElementById("teaser_caption"),"click",function(){t.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),openChatDecider(),n=!1}),on(document.getElementById("minimize"),"click",function(){n=!0,open&&slideToggle(),t.emit("ToServerChatChange",{chatOpen:!1,chatHash:chatHash,consultantID:window.$czater.tok}),hideChat()}),on(document.getElementById("windowed"),"click",function(){var e;if(n=!0,hideChat(),document.getElementById("czater-iframe").src.indexOf("getEmailForm")>-1)e=document.getElementById("czater-iframe").src;else{var t="?login="+client_name+"&email="+client_email+"&"+(userSection?"section="+userSection+"&":"")+(additionParams?"addition_params="+JSON.stringify(additionParams)+"&":"")+(set_css_template?"css_template="+set_css_template+"&":"");e=base_url+"chat/getChatWindowed/"+tempHash+"/"+window.$czater.tok+"/"+language+t}var a=300,o=400;0==newLayout?(a=320,o=480):2==newLayout?(a=390,o=600):3==newLayout&&(a=350,o=600),window.open(e+"windowed","_blank","titlebar=0,toolbar=0,location=0,directories=0,menubar=0,status=0,resizable=0,width="+a+",height="+o)}),on(document.getElementById("closeConversation"),"click",function(){0===messagesCount||0===convInProgress?(n=!0,t.emit("ToServerChatChange",{chatOpen:!1,chatHash:chatHash,consultantID:window.$czater.tok}),hideChat(),window.location.href.indexOf("getChatWindowed")>-1&&(createCookie(cookie_prefix+cookie_open,"0",1),window.close())):slideToggle()}),on(document.getElementById("closeConversationMenu"),"click",doCloseConversation),on(document.getElementById("czaterReturn"),"click",function(){chosenSection=null,document.getElementById("czaterReturn").style.display="none",postMessage("czaterReturn",{}),newGetStatus()}),on(document.getElementById("chatHeader"),"click",function(){var e=document.createElement("input");e.setAttribute("type","checkbox"),document.getElementById("czater-contener").appendChild(e),e.focus(),document.getElementById("czater-contener").removeChild(e)}),document.addEventListener("click",function(e){if("switch-conv-from-bot"==e.target.id||e.target.parentNode&&"switch-conv-from-bot"==e.target.parentNode.id){t.emit("ToServerClientSwitchFromBot",{adminHash:window.$czater.tok,chatHash:chatHash});var a=document.getElementById("switch-conv-from-bot");convInProgress=0,a.parentNode.removeChild(a)}}),!recorder||recorder&&!recorder.playback?document.getElementById("czater-iframe").src=e.url:document.getElementById("czater-iframe").src=base_url+"iframe/index";try{var o=new CustomEvent("frameLoaded",{detail:{status:e.status,chatHash:chatHash}});window.dispatchEvent(o)}catch(t){try{(o=document.createEvent("Event")).initEvent("frameLoaded",!0,!0),o.detail={status:e.status,chatHash:chatHash},window.dispatchEvent(o)}catch(e){}}t.emit("ToServerGetSettings",{userHash:window.$czater.tok,chatHash:chatHash,language:language,host:window.location.href,base_url:base_url,patron:patron,idWidget:currentWidget.idWidget}),templateLoaded=!0}},src=base_url+"assets/modules/chat/js/socket.io.js?v=11";main=function(){if(!mainLoaded&&"undefined"!=typeof io270365){mainLoaded=!0,register_tab_GUID();var e=document.getElementsByTagName("body");body=e.length>0?e[0]:document.documentElement;var t=document.getElementsByTagName("head");if(head=t.length>0?t[0]:document.documentElement,!checkChatBlock()){var a={reconnectionDelay:5e3,reconnectionDelayMax:3e4,perMessageDeflate:!1};WebSocket&&(a.transports=["websocket"],a.upgrade=!1),"object"!=typeof socket&&(socket=base_url.indexOf("czaterdev.pl")>-1&&base_url.indexOf("https")>-1?io270365.connect("https://s1.czaterdev.pl",a):base_url.indexOf("czaterdev.pl")>-1?io270365.connect("http://localhost:3001/",a):base_url.indexOf("chater.pl")>-1?io270365.connect(socket_url,a):socket_path?io270365.connect(socket_url,{path:socket_path}):io270365.connect(socket_url,a),Rf2jK5f=socket),client_name&&void 0!==client_name&&null!==client_name&&void 0!==client_name&&"undefined"!==client_name||(client_name=""),client_email&&void 0!==client_email&&null!==client_email&&void 0!==client_email&&"undefined"!==client_email||(client_email=""),""===client_name&&document.getElementsByClassName("hello")[0]&&"B"===document.getElementsByClassName("hello")[0].lastElementChild.nodeName&&(userLogin=document.getElementsByClassName("hello")[0].lastElementChild.textContent,client_name=document.getElementsByClassName("hello")[0].lastElementChild.textContent),canGetUserStatus=!0,socket.on("disconnect",function(e){socketConnected=!1}),socket.on("connect",function(e){if(firstEnter){firstEnter=!1,socketConnected=!0,setTimeout(function(){var e=document.createElement("iframe");e.src=base_url+"themes/new_userpanel/chat/a.html?"+window.$czater.tok,e.style.display="none",e.id="preloadIframe",document.body.appendChild(e)},1),triesInterval=setInterval(function(){if(!chatLoaded)return checkChatBlock()?(socket.disconnect(),void destroy()):void(tries>=maxTries||(++tries,chatLoaded||(mainLoaded=!1,destroy(),main())))},6e4),testInterval=setInterval(function(){socket.emit("ToServerTest",{test:1})},3e5),(new Date).getTime();var t=!0;internetInterval=setInterval(function(){if(socket.connected){if(postMessage("internet",{internet:!0,chosenSection:chosenSection}),!socketConnected&&t){(new Date).getTime();socketConnected=!0,t=!1,null!==document.getElementById("e3D18r_czater")&&"none"!==document.getElementById("e3D18r_czater").style.display&&null!==document.getElementById("czater-contener")&&"on"===document.getElementById("czater-contener").getAttribute("data-display")&&(t=!0,refreshPage())}}else postMessage("internet",{internet:!1}),socketConnected=!1},1e4),currentUrlInterval=setInterval(function(){if(referer!==document.URL&&-1==document.URL.indexOf("getChatWindowed")){if(referer=document.URL,userSection||postMessage("refererSetter",referer),"undefined"!=typeof czatercall&&czatercall&&czatercall.send("banner","sections",{referer:referer}),recorder){var e=new Date,t=date2str(e,"yyyy-MM-dd hh:mm:ss");allowSend=!0,recorder.start=e.getTime();var a=document.URL,n=recorder.compress(recorder.html);socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:t,frameURL:a,chatHash:chatHash,consultantHash:window.$czater.tok,html:n})}tryNewUserData(),ToServerCheckStatus()}},300),connectionsInterval=setInterval(function(){tries>=maxTries&&(tries=0)},3e5)}});var n=!1;socket.on("newGetStatus",function(){newGetStatus()}),socket.on("giveTrialTime",function(e){postMessage("giveTrialTime",e)}),socket.on("changeChosenSection",function(e){postMessage("changeChosenSectionMsg",{chosenSection:chosenSection=e.idSection})}),socket.on("switchToOffline",function(){postMessage("switchToOffline",{})}),socket.on("toClientStopLive",function(e){n=!1,recorder=!1,clearInterval(liveInterval),liveInterval=!1;var t=document.getElementById("mymouse");null!=t&&t.parentNode.removeChild(t)}),socket.on("toClientStartLive",function(e){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=document.documentElement.outerHTML;socket.emit("toServerStartLive",{w:t,h:a,html:o,client:e.client,admin:window.$czater.tok,url:window.location.href}),n=!0,i()}),socket.on("toClientPingUrl",function(e){if(e.url!==window.location.href){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;socket.emit("toServerChangeURL",{w:t,h:a,url:window.location.href,html:document.documentElement.outerHTML,client:e.client,admin:window.$czater.tok,data:e.url})}else i()}),socket.on("ToClientEnableCzatercall",function(e){var t=myCache.getCache(myCache.constants.callLangs),a=myCache.getCache(myCache.constants.callCountries);!e.lang&&t?e.lang=t:(e.lang=e.lang,myCache.setCache(myCache.constants.callLangs,e.lang)),!e.countries&&a?e.countries=a:(e.countries=e.countries,myCache.setCache(myCache.constants.callCountries,e.countries)),0!=e.isOnline&&window.location.href.indexOf("userPanel")<0&&loadScript(srcCall,function(){var t=isMobile.any()?chat_mobile_position:chat_position;if(null!=czatercall_teaser){isMobile.any();var a="1"==t||"3"==t?"left":"right",n=chatInvitationPosition?"position-on-top":"position-on-side";chatInvitationPosition&&""==czatercall_teaser_button.innerHTML&&(czatercall_teaser_button.style.display="none"),czatercall_teaser.classList.add("czatercall-"+a),czatercall_teaser.classList.add(n)}czatercall.init({baseURL:base_url,staticURL:static_url,referer:referer,hash:window.$czater.tok,layout:newLayout,position:chat_position,positionMobile:chat_mobile_position,screenWidth:window.innerWidth,mobile:!!isMobile.any(),urls:urls,settings:e,client:{name:client_name,email:client_email},clientDataAsk:e.clientDataAsk,clientCustomFields:clientCustomFields,markCall:e.markCall,forceCallback:forceCallback,externalCSS:externalCSS,widget:currentWidget}),socket.on("czatercallMessages",function(e){czatercall.listenerSocket(e)})})}),socket.on("CallbackAvailability",function(e){czatercall.send("banner","availability",e)}),socket.on("callbackCheckCode",function(e){czatercall.send("banner","codeVerification",e)}),socket.on("phoneVerified",function(e){czatercall.send("banner","phoneVerified",e)}),socket.on("checkSectionsPayment",function(){czatercall.send("banner","checkSectionsPayment")}),socket.on("callbackSectionChanged",function(e){czaterEvents.sendEvent("callbackSectionChanged",{idSection:e})}),socket.on("ToClientRecordUser",function(e){if(e.record){var t=new Date,a=date2str(t,"yyyy-MM-dd hh:mm:ss");loadScript(srcRecorder,function(){allowSend=!0,recorder=new EventRecorder({recorder:!0,startDate:a});var e=window.location.href,t=recorder.compress(recorder.html);!1===recordingInterval&&(recordingInterval=setInterval(function(){if(socket.connected&&isRecording&&recorder&&recorder.events&&allowSend&&recId&&recorder.events.length-1-frameNumber>100){var e=recorder.compress(JSON.stringify(recorder.events.slice(frameNumber)));socket.emit("toServerUserRecordingPart",{recId:recId,chatHash:chatHash,items:e,consultantHash:window.$czater.tok}),frameNumber=recorder.events.length}},100)),socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:a,frameURL:e,chatHash:chatHash,consultantHash:window.$czater.tok,html:t})})}});var o=!1;socket.on("toClientClick",function(e){s(),document.getElementById("mymouse").style.left=e.x+"px",document.getElementById("mymouse").style.top=e.y+"px",document.getElementById("mymouse").classList.add("click"),setTimeout(function(){document.getElementById("mymouse").classList.remove("click")},500)}),socket.on("toClientMove",function(e){s(),document.getElementById("mymouse").style.left=e.x+"px",document.getElementById("mymouse").style.top=e.y+"px"}),socket.on("toClientScroll",function(e){var t=window.pageYOffset||document.documentElement.scrollTop;(t+=e.y)<0&&(t=0);var a=document.body,n=document.documentElement,o=Math.max(a.scrollHeight,a.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight);t>o&&(t=o),window.scrollTo(0,t)}),socket.on("ToClientRecord",function(e){recId=e.id}),socket.on("ToClientStartNewRecord",function(e){var t=window.location.href,a=new Date,n=date2str(a,"yyyy-MM-dd hh:mm:ss");if(allowSend=!0,recorder){recorder.start=a.getTime();var o=recorder.compress(recorder.html);socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:n,frameURL:t,chatHash:chatHash,consultantHash:window.$czater.tok,html:o})}else loadScript(srcRecorder,function(){var e=(recorder=new EventRecorder({recorder:!0,startDate:n})).compress(recorder.html);socket.emit("toServerStartRecording",{width:recorder.width,height:recorder.height,dateBegin:n,frameURL:t,chatHash:chatHash,consultantHash:window.$czater.tok,html:e})})}),socket.on("queueClientHash",function(e){var t=(new Date).getTime(),a=new Date(t+31536e6),n=e.adminHash,o=e.newClientHash;document.cookie="czater__="+o+"; expires="+a.toUTCString()+"; path=/;",document.cookie="czater__"+n+"="+o+"; expires="+a.toUTCString()+"; path=/;",createCookie(cookie_prefix+cookie_name+window.$czater.tok,o,365),postMessage("queueClientHash",e)}),socket.on("toClientChatIsFree",()=>{var e=(new Date).getTime();e+=864e5,e3D18r_czater.localStorage.setItem("czater_chatBlockedTo_"+window.location.host,e),socket.disconnect()}),socket.on("userStatus",function(e){var t=e.lang;myCache.getCache(myCache.constants.language).language!==t&&myCache.clearCaches(),e.timestamp&&e.refreshClientCache&&myCache.setNewCacheTimestamp(e.timestamp);var a={language:t};if(myCache.setCache(myCache.constants.language,a),e.customFields){const t=window.location.href;let a=e.customFields.filter(e=>{if(void 0!==e.domain&&null!==e.domain&&""!==e.domain){let a=!1;if(e.domain.split("|").map(e=>{t.includes(e)&&(a=!0)}),!a)return!1}return!0});clientCustomFields=a}if(e.adminHash!==window.$czater.tok)return;e.ip&&(ip=e.ip);var n=myCache.getCache(myCache.constants.exclusionsDesktop),o=myCache.getCache(myCache.constants.exclusionsMobile);if(n&&o?(e.exclusionsDesktop=n,e.exclusionsMobile=o):e.exclusionsDesktop&&e.exclusionsMobile&&(myCache.setCache(myCache.constants.exclusionsDesktop,e.exclusionsDesktop),myCache.setCache(myCache.constants.exclusionsMobile,e.exclusionsMobile)),excluded=isExcluded(e),checkExcluded(),e.client.name&&(client_name=e.client.name),e.client.email&&(client_email=e.client.email),firstRefererSent||runTriggers(),!canGetUserStatus)return;canGetUserStatus=!1;let r=!1,i=e.widgets[0];const s=window.$czater.idWidget,c=window.location.href;e.widgets.length>0&&(e.widgets=e.widgets.map(e=>{let t=!1;return r?e:(s&&s==e.idWidget?t=!0:s||(e.domain.indexOf(",")>=0?e.domain.split("|").map(e=>{c.indexOf(e.trim())>=0&&(t=!0)}):c.indexOf(e.domain.trim())>=0&&(t=!0)),t&&(e.selected=!0,r=!0,i=e),e)})),currentWidget=i;var l="";chatHash||(chatHash=e.chatHash),window.$czater.chatHash=chatHash,createCookie(cookie_prefix+cookie_name+window.$czater.tok,chatHash,365),l=base_url+"chat/getClientChat/"+chatHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?",set_windowed&&(l+="windowed=1&"),set_css_template&&(l+="css_template="+set_css_template+"&"),canGetTemplate=!0,myCache.getCache(myCache.constants.template),socket.emit("ToServerGetTemplate",{token:window.$czater.tok,chatHash:chatHash,base:base_url,url:l,language:language,user:e.user,css_template:set_css_template,idWidget:currentWidget.idWidget}),e.unreadMessagesCount>0&&(unreadMessagesCount=e.unreadMessagesCount)}),socket.on("gettemplate",function(e){myCache.setCache(myCache.constants.template,e),canGetTemplate&&(canGetTemplate=!1,chatLoaded=!0,getTemplate(e,socket))}),socket.on("EndConversation",function(e){newGetStatus(),e.adminHash===window.$czater.tok&&(setConversasionOngoing(!1),convInProgress=0,czaterEvents.sendEvent("conversationEnd",{idConversation:e.idConversation}),postMessage("EndConversation",e),updateUnreadMessages("reset"),e.clientHash=chatHash,"object"==typeof SR&&"object"==typeof SyneriseTC&&socket.emit("getConvMsgsForSynerise",e,function(e){e&&czaterSR.sendCustomRequest(1,"czater_ended-chat-conv",{messages:JSON.stringify(e)})}))}),socket.on("ShowClientData",function(e){e.adminHash===window.$czater.tok&&postMessage("ShowClientData",e)}),socket.on("message",function(e){e.adminHash===window.$czater.tok&&(0==messagesCount&&czaterEvents.sendEvent("firstMessage",{name:client_name,email:client_email,idConversation:e.convId}),"function"==typeof document.hasFocus&&!document.hasFocus()&&e.rows&&e.rows[0]&&"consultant"===e.rows[0].whoWrote&&showTitle&&setTimeout(function(){startTitleInterval()},300),e&&e.rows[0]&&"consultant"===e.rows[0].whoWrote&&updateUnreadMessages("add"),messagesCount++,e.showChat&&showChat(!0),convInProgress=1,simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),createCookie(cookie_prefix+cookie_last_section,chosenSection,30),postMessage("message",e))}),socket.on("allowConversation",function(e){e.adminHash===window.$czater.tok&&postMessage("allowConversation",e)}),socket.on("refreshAllUsers",function(e){window.location.reload(!0)}),socket.on("disallowConversation",function(e){e.adminHash===window.$czater.tok&&postMessage("disallowConversation",e)}),socket.on("ConsultantWriting",function(e){e.adminHash==window.$czater.tok&&postMessage("ConsultantWriting",e)}),socket.on("getUserData",function(e){e.adminHash===window.$czater.tok&&(client_name=e.name,client_email=e.email,userLogin&&""!==userLogin.trim()&&(client_name=userLogin),userEmail&&""!==userEmail.trim()&&(client_email=userEmail),postMessage("getUserData",{email:client_email,name:client_name}))}),socket.on("ConsultantBeginConversation",function(e){anotherTab||socket.emit("ToServerChatChange",{chatOpen:!0,chatHash:chatHash,consultantID:window.$czater.tok}),e.adminHash===window.$czater.tok&&(showChat(!0),newGetStatus(),postMessage("ConsultantBeginConversation",1))}),socket.on("ClientBeginConversation",function(e){}),socket.on("ClientGetSection",function(e){e.adminHash===window.$czater.tok&&("offline"===e.status.status&&0==e.status.always?header_offline=e.status.header:header_online=e.status.header,avatar_online=e.status.avatar?window.devicePixelRatio>1.5?e.status.avatar.big:e.status.avatar.small:"",e.status.header&&"on"===contener.getAttribute("data-display")&&(headerMSG.innerHTML=e.status.header),e.status.avatar?(window.devicePixelRatio>1.5?avatar.innerHTML=e.status.avatar.big:avatar.innerHTML=e.status.avatar.small,headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar"),avatar.style.display="block"):(avatar.innerHTML="",headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")))}),socket.on("getSettingsToClient",function(e){if(e.settings.lastSectionAuto){var t=readCookie(cookie_prefix+cookie_last_section);t&&!e.settings.ignoredLastSections.includes(t)&&(userSection=t)}allTriggers=e.settings.triggers,showTitle=e.settings.showTitle,updateSettings(e.settings)}),socket.on("getStatusToClient",function(e){ifKruk=e.status.kruk,tryNewUserData(),setWindowUrlVar(status.status),e.status.timeLeft&&postMessage("timeLeftFromStatus",{timeLeft:e.status.timeLeft}),postMessage("templateLoaded",null===chosenSection?{status:e.status,convInProgress:convInProgress,userSection:userSection}:{status:e.status,convInProgress:convInProgress,onlyCreate:!0,userSection:userSection});const t={};for(const a in e.status.sectionsOffline)t[a]={},t[a].sectionStatus="offline",t[a].consultantStatus=e.status.sectionsOffline[a].status;for(const a in e.status.sectionsOnline)t[a]={},t[a].sectionStatus="online",t[a].consultantStatus=e.status.sectionsOnline[a].status;sectionsStatus=t,welcomeMsg=e.status.welcome,welcome_offlineMsg=e.status.welcome_offline,convInProgress=e.status.convInProgress,changeFirstMessage(),getStatus(e.status);var a=(new Date).getTime();setConversasionOngoing(e.status.convInProgress),unreadMessagesCount=e.status.convInProgress?unreadMessagesCount:0,updateUnreadMessages("show");var n=function(){setTimeout(function(){var t=(new Date).getTime()-a>3e4;e.status.kruk&&!t&&null===chosenSection||0==cssLoaded||"true"!=cssLoaded.getAttribute("data-e3d18r-css-loaded")&&!t||!1!==firstSettingsSent?n():(checkExcluded(),contener.style.display="block",randomizeTime=!0)},100)};n()}),socket.on("getInvolvingActionsToClient",function(e){startInvolvingAction(e)}),socket.on("GetLocation",function(e){for(var t in e)if(e[t][0]&&""!==e[t][0].trim()){var a=e[t][0].toLowerCase();czatercall.send("banner","localisation",a);break}}),socket.on("surveyTemplate",function(e){e.adminHash===window.$czater.tok&&("call"==e.originType&&"undefined"!=typeof czatercall?czatercall.send("banner","survey",e):postMessage("surveyTemplate",e))}),socket.on("UpdateMessage",function(e){postMessage("UpdateMessage",e)}),socket.on("readMessagesByConsultantDone",function(e){postMessage("readMessagesByConsultantDone",e)}),socket.on("setCallStatus",function(e){e.adminHash===window.$czater.tok&&czatercall.setStatus("online"===e.status?"online":"offline",e.schedule,e.availability)})}}function r(){!1===liveInterval&&n&&(liveInterval=setInterval(function(){if(socket.connected&&recorder&&recorder.events){var e=recorder.events.length-liveFrame;if(e>0){var t=recorder.compress(JSON.stringify(recorder.events.slice(-1*e)));socket.emit("toServerUserLivePreview",{chatHash:chatHash,items:t,consultantHash:window.$czater.tok}),liveFrame=recorder.events.length}}},40))}function i(){var e=new Date,t=date2str(e,"yyyy-MM-dd hh:mm:ss");recorder?r():loadScript(srcRecorder,function(){recorder=new EventRecorder({recorder:!0,startDate:t}),window.location.href,r()})}function s(){if(!o){o=!0;var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",static_url+"assets/css/mymouse.css"),all.insertBefore(e,all.childNodes[0]);var t=document.createElement("div"),a=document.createElement("div");t.appendChild(a),t.id="mymouse",document.body.appendChild(t)}}},destroy=function(){mainLoaded=!1,chatLoaded=!1,templateLoaded=!1,firstEnter=!0,y3Qc6aR=void 0,firstSettingsSent=!1,absolutelyFirst=!0,canGetTemplate=!0,canGetUserStatus=!0,firstAnimationCall=!0,firstCookie=!0,null!==all&&null!=all.parentNode&&(all.parentNode.removeChild(all),all=null),null!==triesInterval&&(clearInterval(triesInterval),triesInterval=null),null!==testInterval&&(clearInterval(testInterval),testInterval=null),null!==internetInterval&&(clearInterval(internetInterval),internetInterval=null),null!==connectionsInterval&&(clearInterval(connectionsInterval),connectionsInterval=null),null!==currentUrlInterval&&(clearInterval(currentUrlInterval),currentUrlInterval=null),socket&&socket.disconnect(),socket=!1},$czaterMethods.destroy=destroy,$czaterMethods.getStatus=function(){return userStatus};var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPod/i)},iPad:function(){return navigator.userAgent.match(/iPad/i)},iPhone:function(){return navigator.userAgent.match(/iPhone/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile|Lumia/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()||isMobile.iPad()}};notAutoCreate||("complete"===document.readyState?loadScript(src,main):window.attachEvent?window.attachEvent("onload",function(){loadScript(src,main)}):(body=document.getElementsByTagName("body")[0],interval=setInterval(function(){"complete"===document.readyState&&(clearInterval(interval),loadScript(src,main))},10)));try{cookie&&(chatHash=cookie,window.$czater.chatHash=chatHash,client_name=name,client_email=email,-1===httpRef.indexOf("getChatWindowed")?(createCookie(cookie_prefix+cookie_lastReferer,httpRef,CookieTTL),referer=httpRef):referer=null!==readCookie(cookie_prefix+cookie_lastReferer)?readCookie(cookie_prefix+cookie_lastReferer):window.location.href,postMessage("getUserData",{email:client_email,name:client_name}))}catch(e){chatHash=readCookie(cookie_prefix+cookie_name+window.$czater.tok),chatHash||(chatHash=readCookie(cookie_prefix+cookie_name)),window.$czater.chatHash=chatHash}var frameNumber=0,liveFrame=0;czaterEvents={lagnuagePolish:{triggerWelcome:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Zaproszenie do rozmowy",eventValue:0},triggerPopup:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Wyświetl komunikat",eventValue:0},triggerUserInvolving:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Angażowanie klienta",eventValue:0},triggerCallbackInvitation:{eventCategory:"Czater",eventAction:"Akcje automatyczne",eventLabel:"Rozmowa telefoniczna",eventValue:0},callRequest:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Nowa rozmowa telefoniczna",eventValue:0},callRequestLater:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Rozmowa telefoniczna na później",eventValue:0},callbackReady:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Widget callbacku gotowy",eventValue:0},callbackSectionChanged:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Zmiana działu telefonu",eventValue:0},chatSectionChanged:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zmiana działu czatu",eventValue:0},firstMessage:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Pierwsza wiadomość",eventValue:0},conversationEnd:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Koniec rozmowy",eventValue:0},messageOffline:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Wiadomość offline",eventValue:0},dataAsk:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zapytanie o dane",eventValue:0},dataSave:{eventCategory:"Czater",eventAction:"Czat",eventLabel:"Zapisanie danych",eventValue:0},showChat:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Pokaż okno czatu",eventValue:0},hideChat:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Schowaj okno czatu",eventValue:0},showCallBanner:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Pokaż okno telefonu",eventValue:0},hideCallBanner:{eventCategory:"Czater",eventAction:"Kliknięcie",eventLabel:"Schowaj okno telefonu",eventValue:0}},languageEnglish:{triggerWelcome:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Invitation to conversation",eventValue:0},triggerPopup:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Show popup",eventValue:0},triggerUserInvolving:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Client involving actions",eventValue:0},triggerCallbackInvitation:{eventCategory:"Chater",eventAction:"Automation",eventLabel:"Phone call",eventValue:0},callRequest:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"New phone request",eventValue:0},callRequestLater:{eventCategory:"Czater",eventAction:"Callback",eventLabel:"Phone request for later",eventValue:0},callbackReady:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"Callback widget ready",eventValue:0},callbackSectionChanged:{eventCategory:"Chater",eventAction:"Callback",eventLabel:"Callback section change",eventValue:0},chatSectionChanged:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Chat section change",eventValue:0},firstMessage:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"First message",eventValue:0},conversationEnd:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Conversation end",eventValue:0},messageOffline:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Offline message",eventValue:0},dataAsk:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Ask for data",eventValue:0},dataSave:{eventCategory:"Chater",eventAction:"Chat",eventLabel:"Save client data",eventValue:0},showChat:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Show chat window",eventValue:0},hideChat:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Hide chat window",eventValue:0},showCallBanner:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Show phone window",eventValue:0},hideCallBanner:{eventCategory:"Chater",eventAction:"Click",eventLabel:"Hide phone window",eventValue:0}},setEnabled:function(e){czaterEvents.enabled=!!e},checkIfEnabled:function(){return czaterEvents.enabled},sendEvent:function(e,t){var a={};if(t&&(a=t),"object"==typeof e&&e.value&&(a=e.value),"object"==typeof e&&e.category&&(e=e.category),czaterEvents.callJSHook(e,a),"chatReady"!==e&&"callbackReady"!==e&&"videoCallReady"!==e&&"callbackSectionChanged"!==e&&"chatSectionChanged"!==e){var n;"showCallBanner"===e?socket.emit("toServerClientEvent",{event:"SHOW_CALL"}):"hideCallBanner"===e?socket.emit("toServerClientEvent",{event:"HIDE_CALL"}):"callRequest"!==e&&"callRequestLater"!==e||"true"!=e3D18r_czater.sessionStorage.getItem("czatercallTrigger")?"firstMessage"===e&&"true"==e3D18r_czater.sessionStorage.getItem("czatPopupTrigger")&&(e3D18r_czater.sessionStorage.removeItem("czatPopupTrigger"),socket.emit("toServerClientEvent",{event:"CONVERSATION_START_FROM_TRIGGER"})):(e3D18r_czater.sessionStorage.removeItem("czatercallTrigger"),socket.emit("toServerClientEvent",{event:"PHONECALL_START_FROM_TRIGGER"}));var o=(n="https://www.chaterbiz.com/"===base_url||"https://www.chater.biz/"===base_url?czaterEvents.languageEnglish[e]:czaterEvents.lagnuagePolish[e]).eventValue;a.idConversation&&(o=a.idConversation),czaterEvents.checkIfEnabled()&&czaterEvents.sendCustomEvent(n.eventCategory,n.eventAction,n.eventLabel,o)}},callJSHook:function(e,t){var a="on"+e.charAt(0).toUpperCase()+e.slice(1);"object"==typeof $czaterEvents&&"function"==typeof $czaterEvents[a]&&$czaterEvents[a](t)},sendCustomEvent:function(e,t,a,n){"undefined"!=typeof gtag?czaterEvents.gtagEvent(e,t,a,n):"undefined"!=typeof ga?czaterEvents.analyticsEvent(e,t,a,n):"undefined"!=typeof _gaq&&czaterEvents.gaEvent(e,t,a,n),"undefined"!=typeof dataLayer&&czaterEvents.dataLayerEvent(e,t,a,n)},analyticsEvent:function(e,t,a,n){if(!e)return!1;if(!t)return!1;var o={hitType:"event"};o.eventCategory=e,o.eventAction=t,a&&(o.eventLabel=a),n&&(o.eventValue=n),ga("send",o)},gaEvent:function(e,t,a,n){if(!e)return!1;if(!t)return!1;var o={};o.eventCategory=e,o.eventAction=t,o.eventLabel="",o.eventValue=0,a&&(o.eventLabel=a),n&&(o.eventValue=n),_gaq.push(["_trackEvent",o.eventCategory,o.eventAction,o.eventLabel,o.eventValue])},gtagEvent:function(e,t,a,n){if(!e)return!1;if(!t)return!1;var o={};o.eventCategory=e,o.eventAction=t,o.eventLabel="",o.eventValue=0,a&&(o.eventLabel=a),n&&(o.eventValue=n),gtag("event","Czater",{event_category:e,event_action:t,event_label:a,value:n})},dataLayerEvent:function(e,t,a,n){if(!e)return!1;if(!t)return!1;var o={event:"CzaterEvent"};o.eventCategory=e,o.eventAction=t,o.eventLabel=a||"",o.eventValue=n||"","object"==typeof dataLayer&&"function"==typeof dataLayer.push&&dataLayer.push(o)}},czaterSR={sendCustomRequest:function(e,t,a){ifKruk&&(1==e?this.sendEventTrack(t,a):2==e&&this.sendFormData(t,a))},sendEventTrack:function(e,t){"object"==typeof SR&&("object"!=typeof t&&(t={}),t.Form_action=e,SR.event.track(e,t))},sendFormData:function(e,t){"object"==typeof SyneriseTC&&SyneriseTC.sendFormData(e,t)}},setConversasionOngoing=function(e){contener.setAttribute("conversation-ongoing",e?"1":"0")}}function createCookieSeconds(e,t,a){var n=new Date;n.setTime(n.getTime()+1e3*a);var o="; expires="+n.toGMTString();document.cookie=e+"="+t+o+"; path=/"}function register_tab_GUID(){if("undefined"!=typeof Storage&&"object"==typeof localStorage)try{null==sessionStorage.tabGUID&&(sessionStorage.tabGUID=tab_GUID());var e=sessionStorage.tabGUID;window.addEventListener("storage",storage_Handler,!1),localStorage.tabGUID=e}catch(e){Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=function(){}}}function storage_Handler(e){"tabGUID"==e.key&&e.oldValue!=e.newValue&&tab_Warning()}function tab_GUID(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function tab_Warning(){anotherTab=!0}function setNewUserData(e,t,a){var n={};e&&(n.login=userLogin=client_name=e),t&&(n.email=userEmail=client_email=t),(e||t)&&(postMessage("getUserData",{email:userEmail,name:userLogin}),socket.emit("ToServerClientSaveData",{clientHash:chatHash,adminHash:window.$czater.tok,data:n})),a&&(additionParams=a,sendAdditionParams())}function tryNewUserData(){if(ifKruk){var e=document.querySelector('[ui-sref="app.modal.mail.inbox"]');if(e&&e.childNodes)for(var t in e.childNodes){var a=e.childNodes[t];a&&"ng-binding"===a.className&&"string"==typeof a.innerText&&setNewUserData(a.innerText.trim().replace("\n"," "),!1,{"Dane pobrane z eKruk":"tak"})}}}function setWindowUrlVar(e){"offline"!==e||isSections||always?(windowedUrl=base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?",""!==allegroReferer&&(windowedUrl+="allegroReferer="+allegroReferer+"&")):(windowedUrl=base_url+"chat/getEmailForm/"+tempHash+"/"+window.$czater.tok+"/"+language+"/0/0/false/"+currentWidget.idWidget+"?",""!==allegroReferer&&(windowedUrl+="allegroReferer="+allegroReferer+"&")),set_windowed&&(windowedUrl+="windowed=1&"),set_chat_color&&(windowedUrl+="chat_color="+set_chat_color+"&"),set_message_color&&(windowedUrl+="message_color="+set_message_color+"&"),set_button_color&&(windowedUrl+="button_color="+set_button_color+"&"),set_button_hover_color&&(windowedUrl+="button_hover_color="+set_button_hover_color+"&"),set_button_text_color&&(windowedUrl+="button_text_color="+set_button_text_color+"&"),set_css_template&&(windowedUrl+="css_template="+set_css_template+"&"),"&"===windowedUrl.charAt(windowedUrl.length-1)&&(windowedUrl=windowedUrl.substring(0,windowedUrl.length-1))}function prepareHost(e){return 0===(e=(e=e.trim()).toLowerCase()).indexOf("http://")&&(e=e.substring(7)),0===e.indexOf("https://")&&(e=e.substring(8)),0===e.indexOf("www.")&&(e=e.substring(4)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e}function isExcluded(e){var t=prepareHost(document.URL);if(isMobile.any()){if(isMobile.any())for(var a in e.exclusionsMobile)if(e.exclusionsMobile[a][0]){if(n=e.exclusionsMobile[a][0].toLowerCase(),1===e.exclusionsMobile[a][1]&&-1!==t.indexOf(n))return!0;if(t===n)return!0}}else for(var a in e.exclusionsDesktop)if(e.exclusionsDesktop[a][0]){var n=e.exclusionsDesktop[a][0].toLowerCase();if(1===e.exclusionsDesktop[a][1]&&-1!==t.indexOf(n))return!0;if(t===n)return!0}return!1}function checkExcluded(){null!==all&&(all.style.display=excluded?"none":"block")}function checkReferer(e,t){var a=!1;return t.split("|").forEach(function(t){prepareHost(e).indexOf(prepareHost(t))>-1&&(a=!0)}),a}function newGetStatus(){null===chosenSection&&(headerMSG.innerHTML=button_online),socket.emit("ToServerNewGetStatus",{adminHash:window.$czater.tok,clientHash:chatHash,host:location.href,language:language,chosenSection:chosenSection||0,convInProgress:convInProgress,simpleStatus:simpleStatus,patron:patron})}function updateUnreadMessages(e){null==e||"0"==chatUnreadBadge||"1"!=contener.getAttribute("conversation-ongoing")&&"reset"!==e||("add"===e?(unreadMessagesCount++,"off"===contener.getAttribute("data-display")&&"flex"!==unreadBadge.style.display&&(unreadBadge.style.display="flex")):"reset"===e?(unreadMessagesCount=0,unreadBadge.style.display="none"):"show"===e&&0!==unreadMessagesCount&&null!==unreadMessagesCount?unreadBadge.style.display="flex":"hide"===e&&(unreadBadge.style.display="none"),unreadBadge.innerHTML=unreadMessagesCount)}function checkRefererPlace(e,t){void 0===e&&(e=""),void 0===t&&(t="");var a={found:!1,length:-1};return t.split("|").forEach(function(t){prepareHost(e).indexOf(prepareHost(t))>-1&&t.length>a.length&&(a={found:!0,length:t.length})}),a}function runTriggers(){if(!(document.URL.indexOf("/chat/getChatWindowed/")>-1)){var e=allTriggers["show-chat"],t=allTriggers["display-advert"],a=allTriggers["display-advert-footer"],n=allTriggers["callback-popup"],o=allTriggers["user-involving"];if(e){var r=null,i=-1;if(Object.keys(e).forEach(function(t){var a=e[t],n=checkRefererPlace(referer,a.referer);(n.found&&n.length>i||!r&&n.found)&&(r=a,i=n.length)}),r&&(null===r.dateUsed||"allTheTime"===r.type||"everyRefresh"===r.type)&&("all"===r.mode||"desktop"===r.mode&&!isMobile.any()||"mobile"===r.mode&&isMobile.any())&&("newClient"===r.type&&1==r.sessionCounter||"returningClient"===r.type&&r.sessionCounter>1||"allTheTime"===r.type||"everyRefresh"===r.type)){var s=function(){var e=getComputedStyle(document.getElementById("czater-contener"));if("none"!==e.display&&"hidden"!==e.visibility&&triggerWelcomeSelect){var t=readCookie(cookie_prefix+cookie_trigger_used+r.idTrigger);if(("everyRefresh"===r.type||null===t||t!=r.sessionCounter)&&"on"!==contener.getAttribute("data-display")&&(createCookie(cookie_prefix+cookie_trigger_used+r.idTrigger,r.sessionCounter,CookieTTL),"online"===userStatus||0==r.online)){teaser&&(teaser.classList.add("e3D18r_fadeout"),setTimeout(function(){teaser.classList.add("hidden")},1e3),setTimeout(function(){teaser.style.display="none"},1300)),null!==r.idSection&&setTimeout(function(){postMessage("selectSection",r.idSection)},1e3),czaterEvents.sendEvent("triggerWelcome"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:r.idTrigger}),r.dateUsed=1,showTitle&&setTimeout(function(){startTitleInterval()},300),r.sound&&postMessage("playSound","");var a=r.welcome;if(""!=overwriteWelcomeMessage&&(a=overwriteWelcomeMessage),""!==a&&"off"===contener.getAttribute("data-display")){if(clearTimeout(teaser_timeout),all.querySelector("#welcome_text_inside").innerHTML=a,avatar_online){var n=avatar_online.split(" ");n.splice(1,0,'class="welcome-avatar"'),all.querySelector("#welcome_text_inside").innerHTML+=n.join(" ")}all.querySelector("#trigger-welcome").style.display="block",setTimeout(function(){all.querySelector("#trigger-welcome").classList.remove("hidden")},500);var o=username;null==o&&(o=""),all.querySelector("#welcome_name").innerHTML=o,postMessage("welcomeTrigger",a)}}}},c=parseInt(r.delay);c>=0&&setTimeout(s,1e3*c);var l=parseInt(r.scroll);l>=0&&callIfUserScrolls(l,s),1==r.leaving&&callIfUserLeaves(s)}}if(t&&Object.keys(t).forEach(function(e){var n=t[e];if(checkReferer(referer,n.referer)&&(null===n.dateUsed||"allTheTime"===n.type||"everyRefresh"===n.type)&&("all"===n.mode||"desktop"===n.mode&&!isMobile.any()||"mobile"===n.mode&&isMobile.any())&&("newClient"===n.type&&1==n.sessionCounter||"returningClient"===n.type&&n.sessionCounter>1||"allTheTime"===n.type||"everyRefresh"===n.type)){var o=function(){var o=readCookie(cookie_prefix+cookie_trigger_used+n.idTrigger);if("everyRefresh"===n.type||null===o||o!=n.sessionCounter){createCookie(cookie_prefix+cookie_trigger_used+n.idTrigger,n.sessionCounter,CookieTTL);var r=document.createElement("div");r.setAttribute("id","gray"),r.setAttribute("class","grayCzaterSheet"),r.onclick=function(e){"gray"===e.target.parentNode.id&&this.parentNode.removeChild(this)};var i=document.createElement("div");r.appendChild(i);var s=document.createElement("div");s.setAttribute("id","e3D18r-modal"),s.setAttribute("class","e3D18r-modal");var c=n.header,l=n.text;if(""!=overwriteAdvertHeader&&(c=overwriteAdvertHeader),""!=overwriteAdvertText&&(l=overwriteAdvertText),null==l&&(l=""),r&&i&&s&&l){s.innerHTML='<div id="e3D18r-modal-header">'+c+'</div><div id="e3D18r-modal-content">'+l+"</div>"+a,i.appendChild(s),document.getElementById("e3D18r_czater").appendChild(r),czaterEvents.sendEvent("triggerPopup"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:n.idTrigger}),t[e].dateUsed=1,n.sound&&postMessage("playSound","");var d,u=document.getElementsByClassName("e3D18r-modal-close");for(d=0;d<u.length;d++)u[d].onclick=function(e){for(var t=document.getElementsByClassName("grayCzaterSheet");t.length>0;)t[0].parentNode.removeChild(t[0])}}}},r=parseInt(n.delay);r>=0&&setTimeout(o,1e3*r);var i=parseInt(n.scroll);i>=0&&callIfUserScrolls(i,o),1==n.leaving&&callIfUserLeaves(o)}}),n&&"undefined"!=typeof czatercall)var d=setInterval(function(){czatercall.bannerReady&&(clearInterval(d),Object.keys(n).forEach(function(e){var t=n[e];if(checkReferer(referer,t.referer)&&(null===t.dateUsed||"allTheTime"===t.type||"everyRefresh"===t.type)&&("all"===t.mode||"desktop"===t.mode&&!isMobile.any()||"mobile"===t.mode&&isMobile.any())&&("newClient"===t.type&&1==t.sessionCounter||"returningClient"===t.type&&t.sessionCounter>1||"allTheTime"===t.type||"everyRefresh"===t.type)){var a=function(){var a=readCookie(cookie_prefix+cookie_trigger_used+t.idTrigger);"everyRefresh"!==t.type&&null!==a&&a==t.sessionCounter||(createCookie(cookie_prefix+cookie_trigger_used+t.idTrigger,t.sessionCounter,CookieTTL),e3D18r_czater.sessionStorage.setItem("czatercallTrigger","true"),toggleCallBanner(1),socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),czaterEvents.sendEvent("triggerCallbackInvitation"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:t.idTrigger}),n[e].dateUsed=1,t.sound&&postMessage("playSound",""))},o=parseInt(t.delay);o>=0&&setTimeout(a,1e3*o);var r=parseInt(t.scroll);r>=0&&callIfUserScrolls(r,a),1==t.leaving&&callIfUserLeaves(a)}}))},1e3);if(o&&!checkIsInvolvingActionBlocked()){var u=pickInvolvingActionReferer(o);if(u.found){var m=u.found,h={},v=!1;try{h=JSON.parse(m.text)}catch(e){v=!0}if(!v){for(var g in h)if(0!==h[g].active){var w=e3D18r_czater.localStorage.getItem("e3D18r-triggers-"+m.idTrigger+"-"+g);null==w&&(e3D18r_czater.localStorage.setItem("e3D18r-triggers-"+m.idTrigger+"-"+g,0),w=0),h[g].usesCount=w}else delete h[g];socket.emit("ToServerGetUserInvolving",{clientHash:chatHash,adminHash:window.$czater.tok,id:m.idTrigger,trigger:h,referer:referer})}}}}}function pickInvolvingActionReferer(e){var t={found:!1,length:0};return Object.keys(e).forEach(function(a){var n=e[a];-1!==referer.indexOf(n.referer)&&t.length<=n.referer.length&&("all"===n.mode||"desktop"===n.mode&&!isMobile.any()||"mobile"===n.mode&&isMobile.any())&&(t.found=n,t.length=n.referer.length)}),t}function checkIsInvolvingActionBlocked(){var e=(new Date).getTime();return!(!e3D18r_czater.localStorage||!e3D18r_czater.localStorage.getItem("involvingActionBlockade"))&&parseInt(e3D18r_czater.localStorage.getItem("involvingActionBlockade"))+864e5>e}function blockInvolvingAction(){var e=(new Date).getTime();e3D18r_czater.localStorage.setItem("involvingActionBlockade",e)}function unblockInvolvingAction(){e3D18r_czater.localStorage.removeItem("involvingActionBlockade")}function getLastDisplayedInvAct(e){return e3D18r_czater.localStorage.getItem("e3D18r-triggers-last-use-"+e)}function setLastDisplayedInvAct(e,t){e3D18r_czater.localStorage.setItem("e3D18r-triggers-last-use-"+e,t)}function startInvolvingAction(e){0==e.delay&&(e.delay=1);var t=getLastDisplayedInvAct(e.id),a=!1;if(e.trigger.involvingType5&&"involvingType5"!=t?a="involvingType5":e.trigger.involvingType1&&"involvingType1"!=t?a="involvingType1":e.trigger.involvingType2&&"involvingType2"!=t?a="involvingType2":e.trigger.involvingType3&&"involvingType3"!=t?a="involvingType3":e.trigger.involvingType4&&"involvingType4"!=t&&(a="involvingType4"),a){setLastDisplayedInvAct(e.id,a),czaterEvents.sendEvent("triggerUserInvolving"),socket.emit("ToServerSetTriggerUsed",{clientHash:chatHash,adminHash:window.$czater.tok,id:e.id});var n=document.createElement("div");n.setAttribute("id","e3D18r-user-involving-action");var o=window.innerWidth;n.classList.add("czater-main-bg"),n.classList.add("czater-main-txt"),chatInvitationPosition&&o>769?n.setAttribute("czater-inv-act-position","higher"):n.setAttribute("czater-inv-act-position","lower"),o>769?1==chat_position||3==chat_position?(n.setAttribute("czater-inv-act-side","left"),n.setAttribute("czater-inv-act-state","off")):(n.setAttribute("czater-inv-act-side","right"),n.setAttribute("czater-inv-act-state","off")):1==chat_mobile_position||3==chat_mobile_position?(n.setAttribute("czater-inv-act-side","left"),n.setAttribute("czater-inv-act-state","off")):(n.setAttribute("czater-inv-act-side","right"),n.setAttribute("czater-inv-act-state","off")),n.innerHTML=e.trigger[a].message,document.getElementById("e3D18r_czater").appendChild(n);var r=document.createElement("div"),i=document.createElement("div");r.classList.add("class","e3D18r-icon-bundle"),r.classList.add("class","e3D18r-involving-close"),i.classList.add("e3D18r-icon-bundle"),i.classList.add("e3D18r-involving-icon"),"black"===text_msg_color?(r.classList.add("class","e3D18r-icon-zamknij_black"),"involvingType5"==a?i.classList.add("e3D18r-icon-basket-black"):i.classList.add("e3D18r-icon-eye-black")):(r.classList.add("class","e3D18r-icon-zamknij"),"involvingType5"==a?i.classList.add("e3D18r-icon-basket-white"):i.classList.add("e3D18r-icon-eye-white")),n.appendChild(r),n.appendChild(i),setTimeout(function(){n.setAttribute("czater-inv-act-state","on")},3e3),setTimeout(function(){n.setAttribute("czater-inv-act-state","off")},14e3),n.onclick=function(e){blockInvolvingAction(),n.setAttribute("czater-inv-act-state","off")}}else setLastDisplayedInvAct(e.id,"")}function changeNavigation(){"black"===text_msg_color&&(minimize.className="e3D18r-icon-bundle e3D18r-icon-zmniejsz_black",windowed.className="e3D18r-icon-bundle e3D18r-icon-w-oknie_black",null!==contenerTeaserCaption&&(contenerTeaserClose.className="e3D18r-icon-bundle e3D18r-icon-zamknij_black"),closeConversation.className="e3D18r-icon-bundle e3D18r-icon-zamknij_black",czaterReturn.innerHTML='<div class="e3D18r-icon-bundle e3D18r-icon-arrow_black"></div>')}function postMessage(e,t){var a={type:e,value:t};iframeWindow&&iframeWindow.postMessage(JSON.stringify(a),"*")}function b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function sendAdditionParams(){additionParams&&socket.emit("ToServerAdditionParams",{adminHash:window.$czater.tok,clientHash:chatHash,additionParams:additionParams})}function ToServerCheckStatus(){document.URL.indexOf("getChatWindowed")>-1&&(referer=document.referrer);var e=myCache.getCache(myCache.constants.timestamp),t=myCache.getCache(myCache.constants.exclusionsDesktop);socket.emit("ToServerCheckStatus",{consultantID:window.$czater.tok,language:language,baseUrl:base_url,size:{width:w,height:h},url:referer,referer:referer,firstReferer:firstReferer,chatHash:chatHash,chatOpen:"1"===readCookie(cookie_prefix+cookie_open),client_name:userLogin,client_email:userEmail,cachedExclusion:!!t,cacheTimestamp:e})}function toggleCallBanner(e){czatercall.swapView(e),1==e?(socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),socket.emit("ToServerGetLocation",{list:[ip]}),czaterEvents.sendEvent("showCallBanner")):czaterEvents.sendEvent("hideCallBanner")}function WindowMessageListener(e){try{var t="";try{t=JSON.parse(e.data)}catch(e){}if("preloadIframe"===t.type){var a=document.getElementById("preloadIframe");a.parentNode.removeChild(a),window.screen.width||window.screen.availWidth||window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.screen.height||window.screen.availHeight||window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,!t.value||forceCookie||clientPerDomain||(chatHash=t.value),setTimeout(function(){ToServerCheckStatus(),sendAdditionParams()},1)}if("chatIcon"===t.type&&!document.getElementById("e3D18r-icon-promo-style")){var n=document.createElement("style");n.setAttribute("id","e3D18r-icon-promo-style"),n.innerHTML=".e3D18r-icon-promo { "+t.value.icon+" }",document.body.appendChild(n),function e(t,a){"object"==typeof czatercall&&czatercall.bannerReady?czatercall.send("banner","chatIcon",t.value):a<5&&(a++,setTimeout(function(){e(t,a)},1e3))}(t,0)}if("removeData"===t.type&&(client_email="",client_name=""),"userSaveData"===t.type&&(void 0!==t.value.name&&(client_name=t.value.name),void 0!==t.value.email&&(client_email=t.value.email),userLogin&&""!==userLogin.trim()&&(client_name=userLogin),userEmail&&""!==userEmail.trim()&&(client_email=userEmail),socket.emit("ToServerClientSaveData",{clientHash:chatHash,adminHash:window.$czater.tok,data:t.value}),sendAdditionParams()),"frameLoaded"===t.type&&(isSections=parseInt(t.isSections),messagesCount=parseInt(t.messages),iframeNewMessage=document.getElementById("czater-iframe"),iframeParent=iframeNewMessage.parentNode,iframeWindow=iframeNewMessage.contentWindow||iframeNewMessage,postMessage("internet",{internet:!0,chosenSection:chosenSection}),postMessage("getUserData",{email:userEmail,name:userLogin,emailReadOnly:!!window.$czater.email,nameReadOnly:!!window.$czater.login}),client_name&&void 0!==client_name&&null!==client_name&&void 0!==client_name&&"undefined"!==client_name||(client_name=""),client_email&&void 0!==client_email&&null!==client_email&&void 0!==client_email&&"undefined"!==client_email||(client_email=""),null===client_name&&null===client_email&&socket.emit("ToServerGetUserData",{chatHash:chatHash,consultantID:window.$czater.tok,base_url:base_url}),userLogin&&""!==userLogin.trim()&&(client_name=userLogin),userEmail&&""!==userEmail.trim()&&(client_email=userEmail),frameLoadedDetail.userLogin=client_name,frameLoadedDetail.userEmail=client_email,frameLoadedDetail.hideBrand=hideBrand,frameLoadedDetail.specialReferer=httpRef||referer,frameLoadedDetail.userSection=userSection,frameLoadedDetail.forceOffline=forceOffline,frameLoadedDetail.clientCustomFields=clientCustomFields,frameLoadedDetail.idSectionDefault=idSectionDefault,frameLoadedDetail.templateData=templateData,frameLoadedDetail.set_css_template=set_css_template,frameLoadedDetail.externalCSS=externalCSS,frameLoadedDetail.overwriteWelcomeOnline=overwriteWelcomeOnline,frameLoadedDetail.overwriteWelcomeOffline=overwriteWelcomeOffline,postMessage("templateLoaded",frameLoadedDetail),firstRefererSent&&(firstRefererSent=!1,runTriggers(),!1!==userSection&&postMessage("selectSection",userSection)),""!==allegroReferer&&postMessage("allegroReferer",allegroReferer),postMessage("isNowOnline","offline"!==userStatus),contener.style.visibility="visible",socket.emit("queueClientHash",{adminHash:$czater.tok,clientHash:tempHash,email:client_email,reliable:window.$czater.email&&window.$czater.email===client_email?1:0}),socket.emit("getMsgReadByConsultant",{adminHash:$czater.tok,clientHash:tempHash}),absolutelyFirst&&(absolutelyFirst=!1,newGetStatus())),"convInProgress"===t.type&&(convInProgress=1,simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),chosenSection=t.value.idSection),"newGetStatus"===t.type&&newGetStatus(),"ClientSendMessage"===t.type){if(anotherTab&&!t.value.isCodeValid)return;userLogin&&""!==userLogin.trim()&&(t.value.clientNameInput=userLogin.trim()),userEmail&&""!==userEmail.trim()&&(t.value.clientEmailInput=userEmail.trim()),t.value.referer=referer,"SPACEARMY"===t.value.message&&(t.value.message="https://spacearmy.swy.pl"),t.value.isCodeValid&&0!=convInProgress&&socket.emit("ContinuePaidChat",t.value.code,chatHash),1!=convInProgress&&(newGetStatus(),convInProgress=1,setTimeout(function(){sendAdditionParams()},1e3)),t.value.reliable=window.$czater.email&&window.$czater.email===t.value.clientEmailInput?1:0,simpleStatus=0,e3D18r_czater.localStorage.setItem("simpleStatus",0),socket.emit("ToServerClientSendMessage",t.value)}if("turnOnPreview"===t.type&&socket.emit("toServerClientTurnedPreview",t.value),"ClientGetSection"===t.type&&(chosenSection=0===t.value.department.id?null:t.value.department.id,changeFirstMessage(),t.value.baseUrl=base_url,t.value.language=language,0!==t.value.department.id&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="block"),newGetStatus()),"chatSectionChanged"===t.type&&czaterEvents.sendEvent("chatSectionChanged",{idSection:t.value.section}),"ClientWriting"===t.type&&(anotherTab&&(anotherTab=!1,register_tab_GUID()),t.value.adminHash=window.$czater.tok,socket.emit("ToServerClientWriting",t.value)),"MarkConversation"===t.type&&socket.emit("ToServerMarkConversation",t.value),"letToChoose"===t.type&&(firstRefererSent=!0,iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?"+(set_css_template?"css_template="+set_css_template+"&":"")),iframeParent.append(iframeNewMessage)),"letToChoose2"===t.type&&(iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",base_url+"chat/getClientChat/"+tempHash+"/"+window.$czater.tok+"/"+language+"/"+currentWidget.idWidget+"?"+(set_css_template?"css_template="+set_css_template+"&":"")),iframeParent.append(iframeNewMessage)),"queueClientHashDone"===t.type&&refreshPage(),"changeLocation"===t.type){if(iframeNewMessage.getAttribute("src")+"#"==t.value)return;iframeNewMessage.remove(),iframeNewMessage.setAttribute("src",t.value),iframeParent.append(iframeNewMessage)}if("showReturnButton"===t.type&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="block"),"changeHeader"===t.type&&"on"===contener.getAttribute("data-display")&&("offline"===t.mode?header_content=header_online:(header_content=header_online,avatar.innerHTML=button_online),headerMSG.innerHTML=header_content),"hideReturnButton"===t.type&&document.getElementById("czaterReturn")&&(document.getElementById("czaterReturn").style.display="none"),"readMessagesByClient"===t.type&&(stopTitleInterval(),updateUnreadMessages("reset"),document.hidden||socket.emit("readMessagesByClient",{adminHash:window.$czater.tok,clientHash:chatHash})),"czatercallMessage"===t.type){var o=t.value;switch(o.type){case"switchView":toggleCallBanner(o.switch);break;case"callbackReady":czaterEvents.sendEvent("callbackReady");break;case"readiness":czaterCallbackUserSection=czaterCallbackUserSection||!1,czatercall.listnerReadiness(o.value,czaterCallbackUserSection);break;case"isOver":socket.emit("CallbackServer",{type:"isOver",call:o.call});break;case"callsRating":socket.emit("CallbackServer",{type:"survey",call:o.call,mark:o.mark,comment:o.comment});break;case"verifyNumber":socket.emit("CallbackServer",{type:"verifyNumber",number:o.number,from:o.from});break;case"requestCall":czatercall.number=o.number,"now"===o.when?czaterEvents.sendEvent("callRequest"):czaterEvents.sendEvent("callRequestLater"),socket.emit("CallbackServer",{type:"clientCall",call:null,callsType:o.callsType,mode:"multi",adminHash:window.$czater.tok,chatHash:chatHash,section:o.section,patron:patron,number:o.number,when:o.when,timezoneOffset:-(new Date).getTimezoneOffset()/60,referer:window.location.href});break;case"showTeaser":1==o.value?czatercall_teaser.style.visibility="visible":czatercall_teaser.style.visibility="hidden";break;case"clientData":postMessage("editClientData",o.toSend);break;case"getCallStatus":socket.emit("getCallStatus",{adminHash:window.$czater.tok,idSection:o.idSection,timezoneOffset:-(new Date).getTimezoneOffset()/60});break;case"checkAvailability":socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash,code:o.code});break;case"checkCode":socket.emit("CallbackServer",{type:"checkCode",code:o.code})}}"googleAnalytics"===t.type&&czaterEvents.sendEvent(t.value),"syneriseEvent"===t.type&&czaterSR.sendCustomRequest(t.value.kind,t.value.name,t.value.params),"messageOfflineSend"===t.type&&doCloseConversation(),"surveyDone"===t.type&&socket.emit("saveSurvey",t.value),"getPrevMessages"===t.type&&socket.emit("getPrevMessages",{adminHash:window.$czater.tok,clientHash:chatHash,idSection:t.value.idSection,lastMessageId:t.value.lastMessageId},function(e){postMessage("setPrevMessages",e)})}catch(e){console.error("!!!",e)}}function slideToggle(){var e=document.getElementById("closeConversationMenu");open?(open=!1,e.style.display="none"):(open=!0,e.style.display="inline")}function loadCSS(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),head.appendChild(t)}function loadScript(e,t){var a=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t,a.appendChild(n)}function changeFirstMessage(){null!==welcomeMsg&&null!==welcome_offlineMsg&&null!==sectionsStatus&&(convInProgress||(sectionsStatus[chosenSection]&&"offline"==sectionsStatus[chosenSection].consultantStatus?postMessage("welcomeTrigger",ifKruk?"Dzień dobry w tej chwili nasi doradcy są zajęci, prosimy o cierpliwe oczekiwanie na rozpoczęcie konwersacji":welcome_offlineMsg):postMessage("welcomeTrigger",welcomeMsg)))}function getStatus(e){(frameLoadedDetail={}).status=e,username=e.username,previousStatusData=e,isMobile.any()&&("offline"===e.status?e.button=e.mobile_offline_button:e.button=e.mobile_online_button),null===e.idConsultant&&isAvatar&&(isAvatar=!1,avatar.innerHTML=""),e.button&&"on"!==contener.getAttribute("data-display")&&(headerMSG.innerHTML=e.button),userStatus!==e.status&&"offline"===e.status&&1!=always&&(isAvatar=!1,idConsultant=null),avatar_online=e.avatar?window.devicePixelRatio>1.5?e.avatar.big:e.avatar.small:"",0==e.sectionsCount&&(chosenSection="0"),idConsultant=e.idConsultant,e.bot&&!e.isOnlyBots&&(e.convInProgress||convInProgress)&&(e.header+=' <div id="switch-conv-from-bot" title="'+switch_from_bot+'"> <div class="e3D18r-icon-bundle e3D18r-icon-bot-to-consultant"></div></div>'),header_consultant=e.header,header_online="online"==e.status?e.online_header:e.offline_header,button_online=e.button;var t=contener.getAttribute("data-display");if("off"===t?headerMSG.innerHTML!=button_online&&(headerMSG.innerHTML=button_online):null===chosenSection&&e.sectionsCount>0?(headerMSG.innerHTML=header_online,isAvatar=!1,avatar.innerHTML=""):headerMSG.innerHTML!=header_consultant&&(headerMSG.innerHTML=header_consultant),userStatus!==e.status||!isAvatar||header_online!==e.header||e.bot){isAvatar=!1,avatar.innerHTML="",userStatus=e.status;var a="";"black"===text_msg_color?(a=1==e.always||"online"==userStatus?"e3D18r-icon-message_black":"e3D18r-icon-message_offline_1_black",status.setAttribute("class","black czater-status czater-status-"+(1!=e.always?userStatus:"online")+" e3D18r-icon-bundle "+a)):(a=1==e.always||"online"==userStatus?"e3D18r-icon-message":"e3D18r-icon-message_offline_1",status.setAttribute("class","czater-status czater-status-"+(1!=e.always?userStatus:"online")+" e3D18r-icon-bundle "+a)),1!=e.always?contener.setAttribute("data-status",e.status):contener.setAttribute("data-status","online"),!e.avatar||"off"!==t&&null===chosenSection?(headerMSG.classList.remove("withAvatar"),headerMSG.classList.add("withoutAvatar")):(isAvatar=!0,window.devicePixelRatio>1.5?avatar.innerHTML=e.avatar.big:avatar.innerHTML=e.avatar.small,"on"===t&&isAvatar&&(headerMSG.classList.remove("withoutAvatar"),headerMSG.classList.add("withAvatar"))),e.countNewMessages>0&&(countNewMessages.innerHTML=e.countNewMessages,"black"===text_msg_color?countNewMessages.setAttribute("class","black czater-status czater-enable"):countNewMessages.setAttribute("class","czater-status czater-enable"))}postMessage("isBot",e.bot&&(e.convInProgress||convInProgress)),postMessage("isNowOnline","offline"!==userStatus)}function updateTemplate(e){var t=function(){if(e.template.timestamp,document.getElementById("deferred-styles"),isMobile.any()){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",static_url+"assets/modules/chat/css/chat_mobile.css"),all.insertBefore(t,all.childNodes[0])}if(Array.isArray(externalCSS))for(var a=0;a<externalCSS.length;a++){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",externalCSS[a]),all.insertBefore(n,all.childNodes[0])}var o;if(Array.isArray(e.template.css))for(urls=e.template.css,a=0;a<urls.length;++a){var r=urls[a];r.auto&&((o=document.createElement("link")).setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",static_url+"assets/css/advanced/"+window.$czater.tok+"_"+r.name+".min.css"),all.insertBefore(o,all.childNodes[0]))}var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",static_url+"assets/modules/chat/css/icons/icons.data.svg.css"),i.setAttribute("as","style"),i.setAttribute("data-e3D18r-css-loaded","false"),i.setAttribute("onload","this.setAttribute('data-e3D18r-css-loaded', 'true')"),cssLoaded=i,all.insertBefore(i,all.childNodes[0]);var s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",static_url+"assets/modules/chat/css/chat"+e.newLayout+"_outside.css"),all.insertBefore(s,all.childNodes[0]);var c=document.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",static_url+"assets/css/user/"+window.$czater.tok+"_language.min.css"),all.insertBefore(c,all.childNodes[0]);let l=e.template.widgets.hash;var d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",static_url+"assets/css/user/"+l+".min.css"),all.insertBefore(d,all.childNodes[0])},a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(a?a(function(){window.setTimeout(t,0)}):window.addEventListener("load",t),all=document.getElementById(e.template.prefix+"_czater"),iframeNewMessage=all.querySelector("#czater-iframe"),header=all.querySelector("#chatHeader"),unreadBadge=all.querySelector("#unreadBadge"),status=all.querySelector("#status"),avatar=all.querySelector("#e3D18r-avatar")||all.querySelector("#avatar"),headerMSG=all.querySelector("#headerMSG"),contener=all.querySelector("#czater-contener"),teaser=all.querySelector("#teaser"),czatercall_teaser=all.querySelector("#czatercall-teaser"),czatercall_teaser_caption=all.querySelector("#czatercall-teaser_caption"),czatercall_teaser_button=all.querySelector("#czatercall-teaser-button"),welcomeCloseSelect=all.querySelector("#welcome_close"),triggerWelcomeSelect=all.querySelector("#trigger-welcome"),null!==teaser){var n=(new Date).getTime();readCookie(cookie_prefix+teaser_shown)?teaser.classList.remove("hidden"):teaser_timeout=setTimeout(function(){createCookie(cookie_prefix+teaser_shown,n,1),teaser.classList.add("e3D18r_fadein"),teaser.classList.remove("hidden")},5e3)}if(null!==czatercall_teaser){null==e3D18r_czater.localStorage.czatercall_teaser&&e3D18r_czater.localStorage.setItem("czatercall_teaser","0");var o=all.querySelector("#czatercall-teaser_close");czatercall_teaser_caption.onclick=function(){null!==czatercall_teaser&&(czatercall_teaser.style.display="none"),"undefined"!=typeof czatercall&&(socket.emit("CallbackServer",{type:"checkAvailability",adminHash:window.$czater.tok,timezoneOffset:-(new Date).getTimezoneOffset()/60,chatHash:chatHash}),toggleCallBanner(1),czaterEvents.sendEvent("showCallBanner"))},o.onclick=function(){null!==czatercall_teaser&&(e3D18r_czater.localStorage.setItem("czatercall_teaser","1"),czatercall_teaser.style.display="none")},!isMobile.any()&&window.innerWidth>769&&"1"!=e3D18r_czater.localStorage.getItem("czatercall_teaser")&&setTimeout(function(){"undefined"!=typeof czatercall&&"block"!=czatercall.iBanner.style.display&&(czatercall_teaser.classList.add("e3D18r_fadein"),czatercall_teaser.classList.remove("hidden"),czatercall_teaser.style.display="flex")},5e3)}contenerTeaserCaption=all.querySelector("#teaser_caption"),countNewMessages=all.querySelector("#countNewMessages"),windowed=all.querySelector("#windowed"),minimize=all.querySelector("#minimize"),closeConversation=all.querySelector("#closeConversation"),closeConversationMenu=all.querySelector("#closeConversationMenu"),contenerTeaserClose=all.querySelector("#teaser_close"),czaterReturn=all.querySelector("#czaterReturn");var r=document.querySelector("meta[name=viewport]");if(r){var i=r.getAttribute("content");i?-1===i.indexOf("width=device-width")&&(noViewPort=!0):noViewPort=!0}else noViewPort=!0;eventsStarted||events()}function updateSettings(e){if("ok"!==e.token&&(headerMSG.innerHTML=header_online=button_online="Nieprawidłowy kod czatu",window.token=!1),void 0!==e.always&&(always=e.always),switch_from_bot=e.switch_from_bot,e.newLayout=3,firstSettingsSent){if(firstSettingsSent=!1,window.token){if((e.exclusionDesktop&&!isMobile.any()||e.exclusionMobile&&isMobile.any())&&(all.style.display="none"),(isRecording=1===e.recordUsers&&isRecording)&&-1===window.location.href.indexOf(base_url.replace("www","proxy"))&&socket.emit("ToServerCheckIfRecord",{chatHash:chatHash,consultantID:window.$czater.tok}),e.videCalllsEnabled&&loadScript(static_url+"/assets/modules/chat/js/video-build.js",function(){setTimeout(function(){if(e.timestamp=timestamp,e.static_url=static_url,e.videoWindowed=videoWindowed,window.$czaterMethods.startVideoWidget(e),e.showVideoButton){var t=document.createElement("div");t.setAttribute("class","e3D18r-icon-bundle e3D18r-icon-camera-white"),t.addEventListener("click",function(){$czaterMethods.toggleVideoCallBanner(!0)}),header.appendChild(t)}czaterEvents.sendEvent("videoCallReady")},1e3)}),window.location.href.indexOf("getChatWindowed")<0||forceCallback){var t=myCache.getCache(myCache.constants.callLangs),a=myCache.getCache(myCache.constants.callCountries);isMobile.any()?e.callsMobileVisibility&&socket.emit("CallbackServer",{type:"start",adminHash:window.$czater.tok,language:language,time:(new Date).toISOString(),cachedCallLangs:!!t,cachedCallCountries:!!a}):socket.emit("CallbackServer",{type:"start",adminHash:window.$czater.tok,language:language,timezoneOffset:-(new Date).getTimezoneOffset()/60,cachedCallLangs:!!t,cachedCallCountries:!!a})}lang=e.lang,hideBrand=e.hideBrand,tempHash=e.hash,chat_color=e.chat_color,set_chat_color=chat_color,text_msg_color=e.text_msg_color,rounded_corners=e.rounded_corners,chat_position=e.chat_position,chat_mobile_position=e.chat_mobile_position,chatInvitationPosition=e.callsInvPosition,avatar_position=e.avatar_position,newLayout=e.newLayout,marking=e.marking,chatUnreadBadge=e.chatUnreadBadge,czaterEvents.setEnabled(e.googleAnalytics),createCookie(cookie_prefix+cookie_name+window.$czater.tok,tempHash,CookieTTL)}setWindowUrlVar(e.status),iframeNewMessage.setAttribute("referrer",window.location.href),lang=languageToCss(lang),contener.setAttribute("data-lang",lang),contener.setAttribute("data-layout",newLayout),headerClass="czater-header czater-header-normal",(isMobile.any()||1===avatar_position||window.location.href.indexOf("getChatWindowed")>-1)&&(headerClass+=" avatarInside windowed"),header.setAttribute("class",headerClass),isTeaserClosed&&null!==teaser&&(teaser.style.display="none"),!allowAutoOpen&&isMobile.any()||"1"!==readCookie(cookie_prefix+cookie_open)&&!autoOpen||isMobile.iPad()||isMobile.iPhone()?(firstCookie&&(hideChat(!1,!0),firstCookie=!1),headerClass="czater-header czater-button",2!==newLayout&&((isMobile.any()||1===avatar_position||window.location.href.indexOf("getChatWindowed")>-1)&&(headerClass+=" avatarInside"),headerClass+=" czater-height"),header.setAttribute("class",headerClass),contener.style.overflow=set_minimized_button?"hidden":"",set_minimized_button&&"off"===contener.getAttribute("data-display")?contener.style.width="41px":contener.style.width=""):firstCookie&&(hideChat(!0,!0),showChat(!0,!0),firstCookie=!1)}absolutelyFirst&&changeNavigation()}function languageToCss(e){for(var t in w4Ue7Lb)if(e===t||e===w4Ue7Lb[t][1]||e===w4Ue7Lb[t][2])return w4Ue7Lb[t][1];return"pol"}function checkChatBlock(){let e=e3D18r_czater.localStorage.getItem("czater_chatBlockedTo_"+window.location.host),t=new Date;return t=t.getTime(),!!(e&&parseInt(e)>t)}function refreshPage(){destroy(),location.reload()}function events(){var e=function(){if(isRecording&&recorder&&recorder.events){var e=1,t=recorder.compress(JSON.stringify(recorder.events.slice(frameNumber)));socket.emit("toServerUserRecordingPart",{dateBegin:recorder.startDate,dateEnd:e,recId:recId,chatHash:chatHash,items:t,consultantHash:window.$czater.tok}),frameNumber=0,allowSend=!1}else isRecording&&recorder&&(e=1,socket.emit("toServerUserRecordingPart",{dateBegin:recorder.startDate,dateEnd:e,recId:recId,chatHash:chatHash,consultantHash:window.$czater.tok}),frameNumber=0,allowSend=!1);setTimeout(function(){},300)},t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),a=navigator.userAgent.match(/Lumia/i),n=navigator.userAgent.match(/Android/i),o="beforeunload";t?(o="unload",window.addEventListener(o,e)):a?(o="pagehide",window.addEventListener(o,e)):n?window.onunload=window.onbeforeunload=function(){e()}:window.addEventListener("beforeunload",e),allowMobileBack&&isMobile.any()&&window.addEventListener("hashchange",function(e){-1!==e.oldURL.indexOf("#chat-window-open")&&-1===e.newURL.indexOf("#chat-window-open")&&hideChat()}),eventsStarted=!0,window.onresize=function(e){var t;window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,"undefined"!=typeof czatercall&&czatercall.iButton&&czatercall.iButton.removeAttribute("class"),t=window.innerWidth<770?1==chat_mobile_position||3==chat_mobile_position?"attachment-mobile-bottom-left":"attachment-mobile-bottom-right":1==chat_position||3==chat_position?"attachment-bottom-left":"attachment-bottom-right","undefined"!=typeof czatercall&&czatercall.iButton&&czatercall.iButton.classList.add(t),!alreadyStarted&&isMobile.any()&&window.innerWidth>=window.innerHeight&&"offline"===userStatus?(contener.style.position="absolute",contener.style.bottom="auto",contener.style.top="0px"):(contener.style.position="",contener.style.bottom="",contener.style.top=""),!alreadyStarted&&isMobile.iPhone()&&window.innerWidth>=window.innerHeight&&window.scrollTo(0,document.body.scrollHeight)},window.onfocus=function(){anotherTab=!1,register_tab_GUID()},null!==contenerTeaserCaption&&(contenerTeaserClose.onclick=function(){createCookie(cookie_prefix+cookie_teaser_closed,"1",CookieTTL),null!==teaser&&(teaser.style.display="none"),minimizePressed=!0}),welcomeCloseSelect&&triggerWelcomeSelect&&(all.querySelector("#welcome_close").onclick=function(e){e.stopPropagation(),all.querySelector("#trigger-welcome").style.display="none"},all.querySelector("#trigger-welcome").addEventListener("click",function(){e3D18r_czater.sessionStorage.setItem("czatPopupTrigger","true")})),czaterEvents.sendEvent("chatReady"),-1!==window.location.href.indexOf("#open_chat")&&$czaterMethods.showChat(!0)}}()}catch(e){console.error(e),"object"==typeof Rf2jK5f&&"function"==typeof Rf2jK5f.emit&&Rf2jK5f.emit("jsError",{time:(new Date).getTime(),type:"client",file:"chat.js",url:document.URL,error:JSON.stringify(e)})}